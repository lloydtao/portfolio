<!doctype html>
<html data-n-head-ssr lang="en" data-n-head="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>lloyd.cx</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" name="format-detection" content="telephone=no"><meta data-n-head="ssr" name="apple-mobile-web-app-title" content="lloyd.cx"><meta data-n-head="ssr" name="application-name" content="lloyd.cx"><meta data-n-head="ssr" name="msapplication-TileColor" content="#111827"><meta data-n-head="ssr" name="theme-color" content="#111827"><meta data-n-head="ssr" data-hid="description" name="description" content="yung software engineer ™"><meta data-n-head="ssr" data-hid="charset" charset="utf-8"><meta data-n-head="ssr" data-hid="mobile-web-app-capable" name="mobile-web-app-capable" content="yes"><meta data-n-head="ssr" data-hid="og:type" name="og:type" property="og:type" content="website"><meta data-n-head="ssr" data-hid="og:title" name="og:title" property="og:title" content="portfolio"><meta data-n-head="ssr" data-hid="og:site_name" name="og:site_name" property="og:site_name" content="portfolio"><meta data-n-head="ssr" data-hid="og:description" name="og:description" property="og:description" content="## Build Setup"><link data-n-head="ssr" rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png"><link data-n-head="ssr" rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link data-n-head="ssr" rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link data-n-head="ssr" rel="manifest" href="/site.webmanifest"><link data-n-head="ssr" rel="mask-icon" href="/safari-pinned-tab.svg" color="#111827"><link data-n-head="ssr" data-hid="shortcut-icon" rel="shortcut icon" href="/_nuxt/icons/icon_64x64.451b4b.png"><link data-n-head="ssr" data-hid="apple-touch-icon" rel="apple-touch-icon" href="/_nuxt/icons/icon_512x512.451b4b.png" sizes="512x512"><link data-n-head="ssr" rel="manifest" href="/_nuxt/manifest.4393f488.json" data-hid="manifest"><link rel="preload" href="/_nuxt/4bb0e76.js" as="script"><link rel="preload" href="/_nuxt/6d3c2ac.js" as="script"><link rel="preload" href="/_nuxt/3d589a9.js" as="script"><link rel="preload" href="/_nuxt/0c8a44b.js" as="script"><link rel="preload" href="/_nuxt/7405a57.js" as="script"><style data-vue-ssr-id="65b97e00:0 15f0552d:0 3354e033:0 90b742cc:0">/*! tailwindcss v2.2.19 | MIT License | https://tailwindcss.com*//*! modern-normalize v1.1.0 | MIT License | https://github.com/sindresorhus/modern-normalize */*,::after,::before{box-sizing:border-box}html{-moz-tab-size:4;-o-tab-size:4;tab-size:4}html{line-height:1.15;-webkit-text-size-adjust:100%}body{margin:0}body{font-family:system-ui,-apple-system,'Segoe UI',Roboto,Helvetica,Arial,sans-serif,'Apple Color Emoji','Segoe UI Emoji'}hr{height:0;color:inherit}abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Consolas,'Liberation Mono',Menlo,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,select{text-transform:none}[type=button],button{-webkit-appearance:button}::-moz-focus-inner{border-style:none;padding:0}legend{padding:0}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}button{background-color:transparent;background-image:none}fieldset{margin:0;padding:0}ol,ul{list-style:none;margin:0;padding:0}html{font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";line-height:1.5}body{font-family:inherit;line-height:inherit}*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:currentColor}hr{border-top-width:1px}img{border-style:solid}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{opacity:1;color:#9ca3af}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}table{border-collapse:collapse}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}button,input,optgroup,select,textarea{padding:0;line-height:inherit;color:inherit}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]{display:none}*,::after,::before{--tw-border-opacity:1;border-color:rgba(229,231,235,var(--tw-border-opacity))}.container{width:100%}@media (min-width:640px){.container{max-width:640px}}@media (min-width:768px){.container{max-width:768px}}@media (min-width:1024px){.container{max-width:1024px}}@media (min-width:1280px){.container{max-width:1280px}}.prose{color:#374151;max-width:65ch}.prose a{color:#111827;text-decoration:underline;font-weight:500}.prose strong{color:#111827;font-weight:600}.prose ol[type="A"]{--list-counter-style:upper-alpha}.prose ol[type="a"]{--list-counter-style:lower-alpha}.prose ol[type="A"s]{--list-counter-style:upper-alpha}.prose ol[type="a"s]{--list-counter-style:lower-alpha}.prose ol[type="I"]{--list-counter-style:upper-roman}.prose ol[type="i"]{--list-counter-style:lower-roman}.prose ol[type="I"s]{--list-counter-style:upper-roman}.prose ol[type="i"s]{--list-counter-style:lower-roman}.prose ol[type="1"]{--list-counter-style:decimal}.prose ol>li{position:relative;padding-left:1.75em}.prose ol>li::before{content:counter(list-item,var(--list-counter-style,decimal)) ".";position:absolute;font-weight:400;color:#6b7280;left:0}.prose ul>li{position:relative;padding-left:1.75em}.prose ul>li::before{content:"";position:absolute;background-color:#d1d5db;border-radius:50%;width:.375em;height:.375em;top:calc(.875em - .1875em);left:.25em}.prose hr{border-color:#e5e7eb;border-top-width:1px;margin-top:3em;margin-bottom:3em}.prose blockquote{font-weight:500;font-style:italic;color:#111827;border-left-width:.25rem;border-left-color:#e5e7eb;quotes:"\201C""\201D""\2018""\2019";margin-top:1.6em;margin-bottom:1.6em;padding-left:1em}.prose blockquote p:first-of-type::before{content:open-quote}.prose blockquote p:last-of-type::after{content:close-quote}.prose h1{color:#111827;font-weight:800;font-size:2.25em;margin-top:0;margin-bottom:.8888889em;line-height:1.1111111}.prose h2{color:#111827;font-weight:700;font-size:1.5em;margin-top:2em;margin-bottom:1em;line-height:1.3333333}.prose h3{color:#111827;font-weight:600;font-size:1.25em;margin-top:1.6em;margin-bottom:.6em;line-height:1.6}.prose h4{color:#111827;font-weight:600;margin-top:1.5em;margin-bottom:.5em;line-height:1.5}.prose figure figcaption{color:#6b7280;font-size:.875em;line-height:1.4285714;margin-top:.8571429em}.prose code{color:#111827;font-weight:600;font-size:.875em}.prose code::before{content:"`"}.prose code::after{content:"`"}.prose a code{color:#111827}.prose pre{color:#e5e7eb;background-color:#1f2937;overflow-x:auto;font-size:.875em;line-height:1.7142857;margin-top:1.7142857em;margin-bottom:1.7142857em;border-radius:.375rem;padding-top:.8571429em;padding-right:1.1428571em;padding-bottom:.8571429em;padding-left:1.1428571em}.prose pre code{background-color:transparent;border-width:0;border-radius:0;padding:0;font-weight:400;color:inherit;font-size:inherit;font-family:inherit;line-height:inherit}.prose pre code::before{content:none}.prose pre code::after{content:none}.prose table{width:100%;table-layout:auto;text-align:left;margin-top:2em;margin-bottom:2em;font-size:.875em;line-height:1.7142857}.prose thead{color:#111827;font-weight:600;border-bottom-width:1px;border-bottom-color:#d1d5db}.prose thead th{vertical-align:bottom;padding-right:.5714286em;padding-bottom:.5714286em;padding-left:.5714286em}.prose tbody tr{border-bottom-width:1px;border-bottom-color:#e5e7eb}.prose tbody tr:last-child{border-bottom-width:0}.prose tbody td{vertical-align:top;padding-top:.5714286em;padding-right:.5714286em;padding-bottom:.5714286em;padding-left:.5714286em}.prose{font-size:1rem;line-height:1.75}.prose p{margin-top:1.25em;margin-bottom:1.25em}.prose img{margin-top:2em;margin-bottom:2em}.prose video{margin-top:2em;margin-bottom:2em}.prose figure{margin-top:2em;margin-bottom:2em}.prose figure>*{margin-top:0;margin-bottom:0}.prose h2 code{font-size:.875em}.prose h3 code{font-size:.9em}.prose ol{margin-top:1.25em;margin-bottom:1.25em}.prose ul{margin-top:1.25em;margin-bottom:1.25em}.prose li{margin-top:.5em;margin-bottom:.5em}.prose>ul>li p{margin-top:.75em;margin-bottom:.75em}.prose>ul>li>:first-child{margin-top:1.25em}.prose>ul>li>:last-child{margin-bottom:1.25em}.prose>ol>li>:first-child{margin-top:1.25em}.prose>ol>li>:last-child{margin-bottom:1.25em}.prose ol ol,.prose ol ul,.prose ul ol,.prose ul ul{margin-top:.75em;margin-bottom:.75em}.prose hr+*{margin-top:0}.prose h2+*{margin-top:0}.prose h3+*{margin-top:0}.prose h4+*{margin-top:0}.prose thead th:first-child{padding-left:0}.prose thead th:last-child{padding-right:0}.prose tbody td:first-child{padding-left:0}.prose tbody td:last-child{padding-right:0}.prose>:first-child{margin-top:0}.prose>:last-child{margin-bottom:0}.prose-sm{font-size:.875rem;line-height:1.7142857}.prose-sm p{margin-top:1.1428571em;margin-bottom:1.1428571em}.prose-sm blockquote{margin-top:1.3333333em;margin-bottom:1.3333333em;padding-left:1.1111111em}.prose-sm h1{font-size:2.1428571em;margin-top:0;margin-bottom:.8em;line-height:1.2}.prose-sm h2{font-size:1.4285714em;margin-top:1.6em;margin-bottom:.8em;line-height:1.4}.prose-sm h3{font-size:1.2857143em;margin-top:1.5555556em;margin-bottom:.4444444em;line-height:1.5555556}.prose-sm h4{margin-top:1.4285714em;margin-bottom:.5714286em;line-height:1.4285714}.prose-sm img{margin-top:1.7142857em;margin-bottom:1.7142857em}.prose-sm video{margin-top:1.7142857em;margin-bottom:1.7142857em}.prose-sm figure{margin-top:1.7142857em;margin-bottom:1.7142857em}.prose-sm figure>*{margin-top:0;margin-bottom:0}.prose-sm figure figcaption{font-size:.8571429em;line-height:1.3333333;margin-top:.6666667em}.prose-sm code{font-size:.8571429em}.prose-sm h2 code{font-size:.9em}.prose-sm h3 code{font-size:.8888889em}.prose-sm pre{font-size:.8571429em;line-height:1.6666667;margin-top:1.6666667em;margin-bottom:1.6666667em;border-radius:.25rem;padding-top:.6666667em;padding-right:1em;padding-bottom:.6666667em;padding-left:1em}.prose-sm ol{margin-top:1.1428571em;margin-bottom:1.1428571em}.prose-sm ul{margin-top:1.1428571em;margin-bottom:1.1428571em}.prose-sm li{margin-top:.2857143em;margin-bottom:.2857143em}.prose-sm ol>li{padding-left:1.5714286em}.prose-sm ol>li::before{left:0}.prose-sm ul>li{padding-left:1.5714286em}.prose-sm ul>li::before{height:.3571429em;width:.3571429em;top:calc(.8571429em - .1785714em);left:.2142857em}.prose-sm>ul>li p{margin-top:.5714286em;margin-bottom:.5714286em}.prose-sm>ul>li>:first-child{margin-top:1.1428571em}.prose-sm>ul>li>:last-child{margin-bottom:1.1428571em}.prose-sm>ol>li>:first-child{margin-top:1.1428571em}.prose-sm>ol>li>:last-child{margin-bottom:1.1428571em}.prose-sm ol ol,.prose-sm ol ul,.prose-sm ul ol,.prose-sm ul ul{margin-top:.5714286em;margin-bottom:.5714286em}.prose-sm hr{margin-top:2.8571429em;margin-bottom:2.8571429em}.prose-sm hr+*{margin-top:0}.prose-sm h2+*{margin-top:0}.prose-sm h3+*{margin-top:0}.prose-sm h4+*{margin-top:0}.prose-sm table{font-size:.8571429em;line-height:1.5}.prose-sm thead th{padding-right:1em;padding-bottom:.6666667em;padding-left:1em}.prose-sm thead th:first-child{padding-left:0}.prose-sm thead th:last-child{padding-right:0}.prose-sm tbody td{padding-top:.6666667em;padding-right:1em;padding-bottom:.6666667em;padding-left:1em}.prose-sm tbody td:first-child{padding-left:0}.prose-sm tbody td:last-child{padding-right:0}.prose-sm>:first-child{margin-top:0}.prose-sm>:last-child{margin-bottom:0}.pointer-events-none{pointer-events:none}.pointer-events-auto{pointer-events:auto}.visible{visibility:visible}.invisible{visibility:hidden}.static{position:static}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.inset-0{top:0;right:0;bottom:0;left:0}.top-0{top:0}.top-1\/2{top:50%}.right-0{right:0}.left-1\/2{left:50%}.z-10{z-index:10}.z-20{z-index:20}.z-30{z-index:30}.mx-auto{margin-left:auto;margin-right:auto}.mt-0{margin-top:0}.mt-1{margin-top:.25rem}.mt-2{margin-top:.5rem}.mt-3{margin-top:.75rem}.mt-5{margin-top:1.25rem}.mt-8{margin-top:2rem}.mt-16{margin-top:4rem}.mt-0\.5{margin-top:.125rem}.mb-3{margin-bottom:.75rem}.block{display:block}.flex{display:flex}.table{display:table}.grid{display:grid}.hidden{display:none}.h-5{height:1.25rem}.h-6{height:1.5rem}.h-24{height:6rem}.h-48{height:12rem}.h-full{height:100%}.w-5{width:1.25rem}.w-6{width:1.5rem}.w-8{width:2rem}.w-48{width:12rem}.w-full{width:100%}.flex-1{flex:1 1 0%}.flex-none{flex:none}.translate-x-0{--tw-translate-x:0px}.translate-x-2{--tw-translate-x:0.5rem}.-translate-x-1\/2{--tw-translate-x:-50%}.translate-y-0{--tw-translate-y:0px}.-translate-y-3{--tw-translate-y:-0.75rem}.-translate-y-1\/2{--tw-translate-y:-50%}.scale-95{--tw-scale-x:.95;--tw-scale-y:.95}.scale-100{--tw-scale-x:1;--tw-scale-y:1}@-webkit-keyframes spin{to{transform:rotate(360deg)}}@keyframes spin{to{transform:rotate(360deg)}}@-webkit-keyframes ping{100%,75%{transform:scale(2);opacity:0}}@keyframes ping{100%,75%{transform:scale(2);opacity:0}}@-webkit-keyframes pulse{50%{opacity:.5}}@keyframes pulse{50%{opacity:.5}}@-webkit-keyframes bounce{0%,100%{transform:translateY(-25%);-webkit-animation-timing-function:cubic-bezier(.8,0,1,1);animation-timing-function:cubic-bezier(.8,0,1,1)}50%{transform:none;-webkit-animation-timing-function:cubic-bezier(0,0,.2,1);animation-timing-function:cubic-bezier(0,0,.2,1)}}@keyframes bounce{0%,100%{transform:translateY(-25%);-webkit-animation-timing-function:cubic-bezier(.8,0,1,1);animation-timing-function:cubic-bezier(.8,0,1,1)}50%{transform:none;-webkit-animation-timing-function:cubic-bezier(0,0,.2,1);animation-timing-function:cubic-bezier(0,0,.2,1)}}.resize{resize:both}.list-inside{list-style-position:inside}.list-disc{list-style-type:disc}.grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.flex-col{flex-direction:column}.items-start{align-items:flex-start}.items-center{align-items:center}.justify-start{justify-content:flex-start}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.gap-3{gap:.75rem}.space-x-0>:not([hidden])~:not([hidden]){--tw-space-x-reverse:0;margin-right:calc(0px * var(--tw-space-x-reverse));margin-left:calc(0px * calc(1 - var(--tw-space-x-reverse)))}.space-x-2>:not([hidden])~:not([hidden]){--tw-space-x-reverse:0;margin-right:calc(.5rem * var(--tw-space-x-reverse));margin-left:calc(.5rem * calc(1 - var(--tw-space-x-reverse)))}.space-x-3>:not([hidden])~:not([hidden]){--tw-space-x-reverse:0;margin-right:calc(.75rem * var(--tw-space-x-reverse));margin-left:calc(.75rem * calc(1 - var(--tw-space-x-reverse)))}.space-x-5>:not([hidden])~:not([hidden]){--tw-space-x-reverse:0;margin-right:calc(1.25rem * var(--tw-space-x-reverse));margin-left:calc(1.25rem * calc(1 - var(--tw-space-x-reverse)))}.space-x-12>:not([hidden])~:not([hidden]){--tw-space-x-reverse:0;margin-right:calc(3rem * var(--tw-space-x-reverse));margin-left:calc(3rem * calc(1 - var(--tw-space-x-reverse)))}.space-y-1>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-top:calc(.25rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.25rem * var(--tw-space-y-reverse))}.space-y-3>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-top:calc(.75rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.75rem * var(--tw-space-y-reverse))}.space-y-5>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-top:calc(1.25rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1.25rem * var(--tw-space-y-reverse))}.space-y-1\.5>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-top:calc(.375rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.375rem * var(--tw-space-y-reverse))}.overflow-hidden{overflow:hidden}.truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.rounded{border-radius:.25rem}.rounded-lg{border-radius:.5rem}.rounded-full{border-radius:9999px}.border{border-width:1px}.border-t{border-top-width:1px}.border-gray-500{--tw-border-opacity:1;border-color:rgba(107,114,128,var(--tw-border-opacity))}.border-gray-600{--tw-border-opacity:1;border-color:rgba(75,85,99,var(--tw-border-opacity))}.border-gray-700{--tw-border-opacity:1;border-color:rgba(55,65,81,var(--tw-border-opacity))}.border-red-500{--tw-border-opacity:1;border-color:rgba(239,68,68,var(--tw-border-opacity))}.hover\:border-gray-500:hover{--tw-border-opacity:1;border-color:rgba(107,114,128,var(--tw-border-opacity))}.bg-black{--tw-bg-opacity:1;background-color:rgba(0,0,0,var(--tw-bg-opacity))}.bg-gray-50{--tw-bg-opacity:1;background-color:rgba(249,250,251,var(--tw-bg-opacity))}.bg-gray-100{--tw-bg-opacity:1;background-color:rgba(243,244,246,var(--tw-bg-opacity))}.bg-gray-200{--tw-bg-opacity:1;background-color:rgba(229,231,235,var(--tw-bg-opacity))}.bg-gray-600{--tw-bg-opacity:1;background-color:rgba(75,85,99,var(--tw-bg-opacity))}.bg-gray-700{--tw-bg-opacity:1;background-color:rgba(55,65,81,var(--tw-bg-opacity))}.bg-gray-800{--tw-bg-opacity:1;background-color:rgba(31,41,55,var(--tw-bg-opacity))}.bg-gray-900{--tw-bg-opacity:1;background-color:rgba(17,24,39,var(--tw-bg-opacity))}.bg-red-500{--tw-bg-opacity:1;background-color:rgba(239,68,68,var(--tw-bg-opacity))}.bg-blue-500{--tw-bg-opacity:1;background-color:rgba(59,130,246,var(--tw-bg-opacity))}.bg-devto-primary{--tw-bg-opacity:1;background-color:rgba(10,10,10,var(--tw-bg-opacity))}.bg-github-primary{--tw-bg-opacity:1;background-color:rgba(33,31,31,var(--tw-bg-opacity))}.bg-instagram-primary{--tw-bg-opacity:1;background-color:rgba(193,53,132,var(--tw-bg-opacity))}.bg-linkedin-primary{--tw-bg-opacity:1;background-color:rgba(10,102,194,var(--tw-bg-opacity))}.bg-spotify-websafe{--tw-bg-opacity:1;background-color:rgba(25,136,75,var(--tw-bg-opacity))}.bg-twitter-websafe{--tw-bg-opacity:1;background-color:rgba(7,120,214,var(--tw-bg-opacity))}.hover\:bg-gray-100:hover{--tw-bg-opacity:1;background-color:rgba(243,244,246,var(--tw-bg-opacity))}.hover\:bg-gray-500:hover{--tw-bg-opacity:1;background-color:rgba(107,114,128,var(--tw-bg-opacity))}.hover\:bg-gray-700:hover{--tw-bg-opacity:1;background-color:rgba(55,65,81,var(--tw-bg-opacity))}.hover\:bg-devto-lighter:hover{--tw-bg-opacity:1;background-color:rgba(49,49,49,var(--tw-bg-opacity))}.hover\:bg-github-lighter:hover{--tw-bg-opacity:1;background-color:rgba(55,53,53,var(--tw-bg-opacity))}.hover\:bg-instagram-lighter:hover{--tw-bg-opacity:1;background-color:rgba(215,110,169,var(--tw-bg-opacity))}.hover\:bg-linkedin-lighter:hover{--tw-bg-opacity:1;background-color:rgba(55,143,233,var(--tw-bg-opacity))}.hover\:bg-spotify-lighter:hover{--tw-bg-opacity:1;background-color:rgba(30,215,96,var(--tw-bg-opacity))}.hover\:bg-twitter-primary:hover{--tw-bg-opacity:1;background-color:rgba(19,155,241,var(--tw-bg-opacity))}.object-cover{-o-object-fit:cover;object-fit:cover}.p-2{padding:.5rem}.p-5{padding:1.25rem}.px-2{padding-left:.5rem;padding-right:.5rem}.px-5{padding-left:1.25rem;padding-right:1.25rem}.px-8{padding-left:2rem;padding-right:2rem}.py-1{padding-top:.25rem;padding-bottom:.25rem}.py-2{padding-top:.5rem;padding-bottom:.5rem}.py-3{padding-top:.75rem;padding-bottom:.75rem}.py-4{padding-top:1rem;padding-bottom:1rem}.py-5{padding-top:1.25rem;padding-bottom:1.25rem}.py-1\.5{padding-top:.375rem;padding-bottom:.375rem}.pt-3{padding-top:.75rem}.pb-3{padding-bottom:.75rem}.pb-5{padding-bottom:1.25rem}.text-left{text-align:left}.text-center{text-align:center}.font-mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}.text-sm{font-size:.875rem;line-height:1.25rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-2xl{font-size:1.5rem;line-height:2rem}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-4xl{font-size:2.25rem;line-height:2.5rem}.font-semibold{font-weight:600}.font-black{font-weight:900}.uppercase{text-transform:uppercase}.italic{font-style:italic}.tracking-wide{letter-spacing:.025em}.text-white{--tw-text-opacity:1;color:rgba(255,255,255,var(--tw-text-opacity))}.text-gray-50{--tw-text-opacity:1;color:rgba(249,250,251,var(--tw-text-opacity))}.text-gray-100{--tw-text-opacity:1;color:rgba(243,244,246,var(--tw-text-opacity))}.text-gray-200{--tw-text-opacity:1;color:rgba(229,231,235,var(--tw-text-opacity))}.text-gray-300{--tw-text-opacity:1;color:rgba(209,213,219,var(--tw-text-opacity))}.text-gray-400{--tw-text-opacity:1;color:rgba(156,163,175,var(--tw-text-opacity))}.text-gray-500{--tw-text-opacity:1;color:rgba(107,114,128,var(--tw-text-opacity))}.text-gray-700{--tw-text-opacity:1;color:rgba(55,65,81,var(--tw-text-opacity))}.text-gray-800{--tw-text-opacity:1;color:rgba(31,41,55,var(--tw-text-opacity))}.text-gray-900{--tw-text-opacity:1;color:rgba(17,24,39,var(--tw-text-opacity))}.text-yellow-400{--tw-text-opacity:1;color:rgba(251,191,36,var(--tw-text-opacity))}.text-blue-400{--tw-text-opacity:1;color:rgba(96,165,250,var(--tw-text-opacity))}.hover\:text-gray-400:hover{--tw-text-opacity:1;color:rgba(156,163,175,var(--tw-text-opacity))}.underline{text-decoration:underline}.opacity-0{opacity:0}.opacity-40{opacity:.4}.opacity-100{opacity:1}*,::after,::before{--tw-shadow:0 0 #0000}.shadow{--tw-shadow:0 1px 3px 0 rgba(0, 0, 0, 0.1),0 1px 2px 0 rgba(0, 0, 0, 0.06);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.shadow-md{--tw-shadow:0 4px 6px -1px rgba(0, 0, 0, 0.1),0 2px 4px -1px rgba(0, 0, 0, 0.06);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}*,::after,::before{--tw-ring-inset:var(--tw-empty, );/*!*//*!*/--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59, 130, 246, 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000}.ring-2{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow,0 0 #0000)}.ring-gray-200{--tw-ring-opacity:1;--tw-ring-color:rgba(229, 231, 235, var(--tw-ring-opacity))}.filter{--tw-blur:var(--tw-empty, );/*!*//*!*/--tw-brightness:var(--tw-empty, );/*!*//*!*/--tw-contrast:var(--tw-empty, );/*!*//*!*/--tw-grayscale:var(--tw-empty, );/*!*//*!*/--tw-hue-rotate:var(--tw-empty, );/*!*//*!*/--tw-invert:var(--tw-empty, );/*!*//*!*/--tw-saturate:var(--tw-empty, );/*!*//*!*/--tw-sepia:var(--tw-empty, );/*!*//*!*/--tw-drop-shadow:var(--tw-empty, );/*!*//*!*/filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.transition{transition-property:background-color,border-color,color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:background-color,border-color,color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:background-color,border-color,color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1);transition-duration:150ms}.duration-100{transition-duration:.1s}.duration-200{transition-duration:.2s}@media (min-width:640px){.sm\:mt-5{margin-top:1.25rem}.sm\:mt-8{margin-top:2rem}.sm\:flex{display:flex}.sm\:hidden{display:none}.sm\:h-64{height:16rem}.sm\:w-64{width:16rem}.sm\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.sm\:flex-row{flex-direction:row}.sm\:items-start{align-items:flex-start}.sm\:justify-between{justify-content:space-between}.sm\:space-x-3>:not([hidden])~:not([hidden]){--tw-space-x-reverse:0;margin-right:calc(.75rem * var(--tw-space-x-reverse));margin-left:calc(.75rem * calc(1 - var(--tw-space-x-reverse)))}.sm\:space-y-0>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0px * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0px * var(--tw-space-y-reverse))}.sm\:space-y-0\.5>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-top:calc(.125rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.125rem * var(--tw-space-y-reverse))}.sm\:pt-3{padding-top:.75rem}.sm\:pb-8{padding-bottom:2rem}.sm\:text-sm{font-size:.875rem;line-height:1.25rem}.sm\:text-xl{font-size:1.25rem;line-height:1.75rem}.sm\:text-3xl{font-size:1.875rem;line-height:2.25rem}.sm\:text-4xl{font-size:2.25rem;line-height:2.5rem}.sm\:text-5xl{font-size:3rem;line-height:1}.sm\:ring-4{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(4px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow,0 0 #0000)}}@media (min-width:768px){.md\:prose-lg{font-size:1.125rem;line-height:1.7777778}.md\:prose-lg p{margin-top:1.3333333em;margin-bottom:1.3333333em}.md\:prose-lg blockquote{margin-top:1.6666667em;margin-bottom:1.6666667em;padding-left:1em}.md\:prose-lg h1{font-size:2.6666667em;margin-top:0;margin-bottom:.8333333em;line-height:1}.md\:prose-lg h2{font-size:1.6666667em;margin-top:1.8666667em;margin-bottom:1.0666667em;line-height:1.3333333}.md\:prose-lg h3{font-size:1.3333333em;margin-top:1.6666667em;margin-bottom:.6666667em;line-height:1.5}.md\:prose-lg h4{margin-top:1.7777778em;margin-bottom:.4444444em;line-height:1.5555556}.md\:prose-lg img{margin-top:1.7777778em;margin-bottom:1.7777778em}.md\:prose-lg video{margin-top:1.7777778em;margin-bottom:1.7777778em}.md\:prose-lg figure{margin-top:1.7777778em;margin-bottom:1.7777778em}.md\:prose-lg figure>*{margin-top:0;margin-bottom:0}.md\:prose-lg figure figcaption{font-size:.8888889em;line-height:1.5;margin-top:1em}.md\:prose-lg code{font-size:.8888889em}.md\:prose-lg h2 code{font-size:.8666667em}.md\:prose-lg h3 code{font-size:.875em}.md\:prose-lg pre{font-size:.8888889em;line-height:1.75;margin-top:2em;margin-bottom:2em;border-radius:.375rem;padding-top:1em;padding-right:1.5em;padding-bottom:1em;padding-left:1.5em}.md\:prose-lg ol{margin-top:1.3333333em;margin-bottom:1.3333333em}.md\:prose-lg ul{margin-top:1.3333333em;margin-bottom:1.3333333em}.md\:prose-lg li{margin-top:.6666667em;margin-bottom:.6666667em}.md\:prose-lg ol>li{padding-left:1.6666667em}.md\:prose-lg ol>li::before{left:0}.md\:prose-lg ul>li{padding-left:1.6666667em}.md\:prose-lg ul>li::before{width:.3333333em;height:.3333333em;top:calc(.8888889em - .1666667em);left:.2222222em}.md\:prose-lg>ul>li p{margin-top:.8888889em;margin-bottom:.8888889em}.md\:prose-lg>ul>li>:first-child{margin-top:1.3333333em}.md\:prose-lg>ul>li>:last-child{margin-bottom:1.3333333em}.md\:prose-lg>ol>li>:first-child{margin-top:1.3333333em}.md\:prose-lg>ol>li>:last-child{margin-bottom:1.3333333em}.md\:prose-lg ol ol,.md\:prose-lg ol ul,.md\:prose-lg ul ol,.md\:prose-lg ul ul{margin-top:.8888889em;margin-bottom:.8888889em}.md\:prose-lg hr{margin-top:3.1111111em;margin-bottom:3.1111111em}.md\:prose-lg hr+*{margin-top:0}.md\:prose-lg h2+*{margin-top:0}.md\:prose-lg h3+*{margin-top:0}.md\:prose-lg h4+*{margin-top:0}.md\:prose-lg table{font-size:.8888889em;line-height:1.5}.md\:prose-lg thead th{padding-right:.75em;padding-bottom:.75em;padding-left:.75em}.md\:prose-lg thead th:first-child{padding-left:0}.md\:prose-lg thead th:last-child{padding-right:0}.md\:prose-lg tbody td{padding-top:.75em;padding-right:.75em;padding-bottom:.75em;padding-left:.75em}.md\:prose-lg tbody td:first-child{padding-left:0}.md\:prose-lg tbody td:last-child{padding-right:0}.md\:prose-lg>:first-child{margin-top:0}.md\:prose-lg>:last-child{margin-bottom:0}.md\:mx-0{margin-left:0;margin-right:0}.md\:h-64{height:16rem}.md\:w-96{width:24rem}.md\:grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.md\:flex-row{flex-direction:row}.md\:space-x-5>:not([hidden])~:not([hidden]){--tw-space-x-reverse:0;margin-right:calc(1.25rem * var(--tw-space-x-reverse));margin-left:calc(1.25rem * calc(1 - var(--tw-space-x-reverse)))}.md\:space-x-8>:not([hidden])~:not([hidden]){--tw-space-x-reverse:0;margin-right:calc(2rem * var(--tw-space-x-reverse));margin-left:calc(2rem * calc(1 - var(--tw-space-x-reverse)))}}@media (min-width:1024px){.lg\:w-3\/4{width:75%}.lg\:grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}}@media (min-width:1280px){.xl\:h-48{height:12rem}.xl\:w-2\/3{width:66.666667%}.xl\:grid-cols-4{grid-template-columns:repeat(4,minmax(0,1fr))}.xl\:grid-cols-6{grid-template-columns:repeat(6,minmax(0,1fr))}}code[class*=language-],pre[class*=language-]{color:#000;background:0 0;text-shadow:0 1px #fff;font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;hyphens:none}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{text-shadow:none;background:#b3d4fc}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{text-shadow:none;background:#b3d4fc}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#9a6e3a;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.nuxt-progress{position:fixed;top:0;left:0;right:0;height:2px;width:0;opacity:1;transition:width .1s,opacity .4s;background-color:#000;z-index:999999}.nuxt-progress.nuxt-progress-notransition{transition:none}.nuxt-progress-failed{background-color:red}body{--tw-bg-opacity:1;background-color:rgba(17,24,39,var(--tw-bg-opacity))}</style><link rel="preload" href="/_nuxt/static/1672247031/projects/gridlink-building-a-scalable-backend/state.js" as="script"><link rel="preload" href="/_nuxt/static/1672247031/projects/gridlink-building-a-scalable-backend/payload.js" as="script"><link rel="preload" href="/_nuxt/static/1672247031/manifest.js" as="script">
  </head>
  <body>
    <div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div><div class="absolute h-full w-full"><img src="/images/bg.svg" width="1920" height="1080" alt="Blue and purple background graphics" class="top-0 w-full"></div> <div class="absolute top-0 h-full w-full"><div><div id="section"><div id="container" class="container mx-auto p-5"><div class="flex"><a href="/" class="flex items-center space-x-3 text-gray-50 duration-100 hover:text-gray-400 flex-1 justify-start nuxt-link-active"><div><img src="/_nuxt/image/c04f6a.webp" width="32" height="32" alt="Pink boxes logo" class="w-8"></div> <span class="text-2xl font-semibold">lloyd.cx</span></a> <div class="hidden items-center space-x-5 sm:flex md:space-x-8 flex-1 justify-center"><a href="/blog/" class="font-semibold text-gray-50 duration-100 hover:text-gray-400">
    Blog
  </a> <a href="/projects/" class="font-semibold text-gray-50 duration-100 hover:text-gray-400 nuxt-link-active">
    Projects
  </a> <a href="/contact/" class="font-semibold text-gray-50 duration-100 hover:text-gray-400">
    Contact
  </a></div> <div class="hidden items-center space-x-3 sm:flex md:space-x-5 flex-1 justify-end"><a href="https://github.com/lloydtao" class="h-6 w-6 text-gray-50 duration-100 hover:text-gray-400"><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="currentColor"><title>GitHub</title> <path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></a> <a href="https://twitter.com/lloydtao" class="h-6 w-6 text-gray-50 duration-100 hover:text-gray-400"><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="currentColor"><title>Twitter</title> <path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"></path></svg></a> <a href="https://linkedin.com/in/lloydtao/" class="h-6 w-6 text-gray-50 duration-100 hover:text-gray-400"><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="currentColor"><title>LinkedIn</title> <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></a></div> <ul class="flex sm:hidden flex-1 justify-end"><li><a href="#" class="absolute right-0 z-30 flex-none px-5"><p class="rounded p-2 font-semibold tracking-wide text-gray-200 hover:bg-gray-900/30"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="h-6 w-6"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg></p></a> <div class="fixed inset-0 z-10 bg-black transition invisible opacity-0"></div> <div class="absolute right-0 z-20 mt-16 w-full px-5 transition pointer-events-none -translate-y-3 translate-x-2 scale-95 opacity-0"><ul class="flex w-full flex-col overflow-hidden rounded bg-gray-50 shadow-md"><li class="flex"><h3 class="flex flex-1 px-5 py-4 font-semibold text-gray-800">
            Navigation
          </h3></li> <li class="flex border-t"><a href="/" class="flex flex-1 px-8 py-4 text-lg font-semibold text-gray-700 hover:bg-gray-100 nuxt-link-active">Home</a></li> <li class="flex"><a href="/blog/" class="flex flex-1 px-8 py-4 text-lg font-semibold text-gray-700 hover:bg-gray-100">Blog</a></li> <li class="flex"><a href="/projects/" class="flex flex-1 px-8 py-4 text-lg font-semibold text-gray-700 hover:bg-gray-100 nuxt-link-active">Projects</a></li> <li class="flex"><a href="/contact/" class="flex flex-1 px-8 py-4 text-lg font-semibold text-gray-700 hover:bg-gray-100">Contact</a></li></ul></div></li></ul></div></div></div> <div class="container mx-auto px-5"><h1 class="mt-5 text-4xl font-black text-gray-100">
    Building a scalable backend
  </h1> <p class="mt-3 text-gray-200">
    December 3, 2022 · Gridlink
  </p> <p class="mt-3 text-lg text-gray-200">
    Building a database and REST API using Django and PostgreSQL
  </p> <div class="prose prose-sm mx-auto mt-8 overflow-hidden rounded bg-gray-100 md:prose-lg"><div class="px-8 pb-5 nuxt-content"><h2 id="introduction"><a href="#introduction" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Introduction</h2>
<p>Django is a framework for building monolithic web applications.</p>
<p>Although not typically associated with performance at scale, a monolith can be feasible if it is kept <strong>stateless</strong> and <strong>modular</strong>.</p>
<ul>
<li>Statelessness, where an application server is dependent only on third-party storage, allows us to leverage horizontal scaling. This is the usage of parallel servers to distribute load across multiple nodes.</li>
<li>Modularity will allow us to easily migrate to a microservices architecture in the future.</li>
</ul>
<p>Django already encourages breaking a project into apps, where each app has its own data models, data views, routes and tests. It also comes with an object-relational mapper (ORM) for interfacing with an SQL database. These characteristics lead to a well-structured Django project being logically similar to microservices.</p>
<p>How about the database? Postgres already does a good job of handling tens of thousands of concurrent requests per second, which means that we won't have to worry about scaling for a while. If needed, we can explore single-master replication, where data is modified on a single write node and replicated to many read nodes.</p>
<p>All in all, the only major drawback is that the entire monolith is replicated when horizontally scaling. This results in a suboptimal usage of server resources, as well as increased scale-out times. For the time being, this is a sound compromise.</p>
<h2 id="models"><a href="#models" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Models</h2>
<p>Database models are defined using Python classes that inherit from Django's <code>models.Model</code> class.</p>
<p>Models are a collection of fields, where each has a field type and various parameters such as constraints, default values and indexes.</p>
<p>Gridlink allows a user to create many grids, where each grid has many links. Here, we define the grid model with Django:</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-python"><code><span class="token keyword">class</span> <span class="token class-name">Grid</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    user <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>User<span class="token punctuation">,</span> on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>CASCADE<span class="token punctuation">,</span> related_name<span class="token operator">=</span><span class="token string">"grids"</span><span class="token punctuation">)</span>
    slug <span class="token operator">=</span> models<span class="token punctuation">.</span>SlugField<span class="token punctuation">(</span>unique<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> db_index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> default<span class="token operator">=</span>generate_slug<span class="token punctuation">)</span>
    title <span class="token operator">=</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>max_length<span class="token operator">=</span><span class="token number">128</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">,</span> blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    created_on <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>auto_now_add<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    modified_on <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    deleted_on <span class="token operator">=</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    is_deleted <span class="token operator">=</span> models<span class="token punctuation">.</span>BooleanField<span class="token punctuation">(</span>default<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
</code></pre></div>
<h2 id="database"><a href="#database" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Database</h2>
<p>After defining the data models, Django provides two commands to create the necessary database tables and columns.</p>
<p>The <code>makemigrations</code> command will generate the migration files that define changes to a database schema. These files are treated as source code and committed to the repository.</p>
<p>Here is the relevant part of the generated migration for creating the grid model:</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-python"><code>migrations<span class="token punctuation">.</span>CreateModel<span class="token punctuation">(</span>
    name<span class="token operator">=</span><span class="token string">"Grid"</span><span class="token punctuation">,</span>
    fields<span class="token operator">=</span><span class="token punctuation">[</span>
        <span class="token punctuation">(</span>
            <span class="token string">"id"</span><span class="token punctuation">,</span>
            models<span class="token punctuation">.</span>BigAutoField<span class="token punctuation">(</span>
                auto_created<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
                primary_key<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>
                serialize<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>
                verbose_name<span class="token operator">=</span><span class="token string">"ID"</span><span class="token punctuation">,</span>
            <span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span>
            <span class="token string">"slug"</span><span class="token punctuation">,</span>
            models<span class="token punctuation">.</span>SlugField<span class="token punctuation">(</span>default<span class="token operator">=</span>grids<span class="token punctuation">.</span>models<span class="token punctuation">.</span>generate_slug<span class="token punctuation">,</span> unique<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token string">"title"</span><span class="token punctuation">,</span> models<span class="token punctuation">.</span>CharField<span class="token punctuation">(</span>blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">,</span> max_length<span class="token operator">=</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token string">"created_on"</span><span class="token punctuation">,</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>auto_now_add<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token string">"modified_on"</span><span class="token punctuation">,</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token string">"deleted_on"</span><span class="token punctuation">,</span> models<span class="token punctuation">.</span>DateTimeField<span class="token punctuation">(</span>blank<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> null<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span><span class="token string">"is_deleted"</span><span class="token punctuation">,</span> models<span class="token punctuation">.</span>BooleanField<span class="token punctuation">(</span>default<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">(</span>
            <span class="token string">"user"</span><span class="token punctuation">,</span>
            models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>
                on_delete<span class="token operator">=</span>django<span class="token punctuation">.</span>db<span class="token punctuation">.</span>models<span class="token punctuation">.</span>deletion<span class="token punctuation">.</span>CASCADE<span class="token punctuation">,</span>
                to<span class="token operator">=</span>settings<span class="token punctuation">.</span>AUTH_USER_MODEL<span class="token punctuation">,</span>
            <span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>
</code></pre></div>
<p>The <code>migrate</code> command will search for unapplied migrations in the project, and then apply these changes to a database. By running this command before spinning up the application, the database will always be in-sync with the defined data models.</p>
<p>Django's object-relational mapper (ORM) can be used to perform CRUD (create, read, update, delete) operations on the database. This allows for interaction with the database using Python code, while still maintaining the performance of raw SQL queries.</p>
<h2 id="api"><a href="#api" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>API</h2>
<p>Django REST framework (<code>django-rest-framework</code>) provides a platter of tools and utilities that make it easy to create API endpoints, including serialisers, viewsets and routers. These allow you to create API endpoints by defining the serialisation, queryset and other behaviors in a declarative manner.</p>
<p>First, we create a serialiser class that defines how a data model should be serialised and deserialised. For example, this is a general serialiser for the link model. By default, the grid's primary key will be serialised, but we can switch this out for its slug instead.</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-python"><code><span class="token keyword">class</span> <span class="token class-name">LinkDetailSerialiser</span><span class="token punctuation">(</span>serializers<span class="token punctuation">.</span>ModelSerializer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    grid <span class="token operator">=</span> serializers<span class="token punctuation">.</span>SlugRelatedField<span class="token punctuation">(</span>slug_field<span class="token operator">=</span><span class="token string">"slug"</span><span class="token punctuation">,</span> read_only<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>

    <span class="token keyword">class</span> <span class="token class-name">Meta</span><span class="token punctuation">:</span>
        model <span class="token operator">=</span> Link
        fields <span class="token operator">=</span> <span class="token string">"__all__"</span>
</code></pre></div>
<p>Once our serialiser is defined, we can use it within a viewset. This is where we write the logic for each HTTP method.</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-python"><code><span class="token keyword">class</span> <span class="token class-name">LinkViewSet</span><span class="token punctuation">(</span>viewsets<span class="token punctuation">.</span>ViewSet<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">create</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

    <span class="token keyword">def</span> <span class="token function">retrieve</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> pk<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        qs <span class="token operator">=</span> Link<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>select_related<span class="token punctuation">(</span><span class="token string">"grid"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        link <span class="token operator">=</span> get_object_or_404<span class="token punctuation">(</span>qs<span class="token punctuation">,</span> slug<span class="token operator">=</span>pk<span class="token punctuation">,</span> is_deleted<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
        serializer <span class="token operator">=</span> LinkDetailSerialiser<span class="token punctuation">(</span>link<span class="token punctuation">)</span>
        <span class="token keyword">return</span> Response<span class="token punctuation">(</span>serializer<span class="token punctuation">.</span>data<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">list</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre></div>
<p>Finally, we can point routes to this viewset.</p>
<p>Since we're using DRF's <code>viewsets.ViewSet</code>, requests are already handled appropriately based on method (<code>GET</code>, <code>POST</code>, etc.) and URL (<code>/links/</code> vs. <code>/links/{id}/</code>).</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-python"><code>links_router <span class="token operator">=</span> routers<span class="token punctuation">.</span>DefaultRouter<span class="token punctuation">(</span><span class="token punctuation">)</span>
links_router<span class="token punctuation">.</span>register<span class="token punctuation">(</span><span class="token string">r"links"</span><span class="token punctuation">,</span> LinkViewSet<span class="token punctuation">,</span> basename<span class="token operator">=</span><span class="token string">"links"</span><span class="token punctuation">)</span>
</code></pre></div>
<p>Perfect! We can now make calls to our API.</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-json"><code><span class="token comment">// GET /api/links/li_287df45a6c294bb397a5acd29cdbf63f/</span>

<span class="token comment">// HTTP 200 OK</span>
<span class="token comment">// Allow: GET, PUT, PATCH, DELETE, HEAD, OPTIONS</span>
<span class="token comment">// Content-Type: application/json</span>
<span class="token comment">// Vary: Accept</span>

<span class="token punctuation">{</span>
  <span class="token property">"slug"</span><span class="token operator">:</span> <span class="token string">"li_287df45a6c294bb397a5acd29cdbf63f"</span><span class="token punctuation">,</span>
  <span class="token property">"grid"</span><span class="token operator">:</span> <span class="token string">"gr_58b5fc7e8e854f469192a928518aea5b"</span><span class="token punctuation">,</span>
  <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"Portfolio"</span><span class="token punctuation">,</span>
  <span class="token property">"background"</span><span class="token operator">:</span> <span class="token string">"/bg/colours.jpg"</span><span class="token punctuation">,</span>
  <span class="token property">"width"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token property">"height"</span><span class="token operator">:</span> <span class="token number">1</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div>
<h3 id="slugs"><a href="#slugs" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Slugs</h3>
<p>Across the API, Gridlink obfuscates the primary keys of objects with slugs to prevent <a href="https://wiki.owasp.org/index.php/Top_10_2013-A4-Insecure_Direct_Object_References" rel="nofollow noopener noreferrer" target="_blank">insecure direct object references</a>.</p>
<p>This is to avoid sequential, predictable keys, which are a source of information leakage. We would like to avoid the potential business impacts, such as exposing the total number objects and the rate of their creation, and technical impacts, such as inviting bad actors to iterate over and archive the database (and possibly cause a denial of service).</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-json"><code><span class="token punctuation">{</span> <span class="token property">"slug"</span><span class="token operator">:</span> <span class="token string">"gr_58b5fc7e8e854f469192a928518aea5b"</span> <span class="token punctuation">}</span>
</code></pre></div>
<p>Inspiration for the format was taken from Stripe's <a href="https://dev.to/stripe/designing-apis-for-humans-object-ids-3o5a" rel="nofollow noopener noreferrer" target="_blank">Designing APIs for humans</a> series. Stripe prefixes slugs with model identifiers to prevent human error, both for internal developers and for their customers.</p>
<h2 id="authentication"><a href="#authentication" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Authentication</h2>
<p>Authentication is the process of identifying, and verifying the identity of, a user. This is initially achieved through the use of a username and password.</p>
<p>To avoid having to store the password and re-send it on every request, which poses an inherent security risk, we can use a token-based system. In short, a token represents the user's credentials, and can be stored and utilised as a guarantee of their identity instead.</p>
<p>We have several token-based solutions available, including:</p>
<ol>
<li>Basic token authentication:
<ul>
<li>One token for all sessions</li>
<li>Tracked in the database and can be revoked (forced logout)</li>
<li>Does not implicitly store details/permissions and must be looked up</li>
</ul>
</li>
<li>JSON Web Token (JWT):
<ul>
<li>One token per session</li>
<li>Does not require database storage, and works on an refresh/expire model</li>
<li>Includes details/permissions signed by the server (can be trusted)</li>
</ul>
</li>
</ol>
<p>Several well-maintained packages for dealing with authentication are available. For example, <code>dj-rest-auth</code> provides methods and respective endpoints for signing up, logging in, resetting and password and social media authentication.</p>
<p>Once installed, the client can fetch and then send their token in their requests:</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-js"><code>headers <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">Vary</span><span class="token operator">:</span> <span class="token maybe-class-name">Origin</span><span class="token punctuation">,</span>
  <span class="token string-property property">'Access-Control-Allow-Origin'</span><span class="token operator">:</span> <span class="token string">'https://gridl.ink'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">Authorization</span><span class="token operator">:</span> <span class="token string">'Token '</span> <span class="token operator">+</span> authtoken <span class="token operator">+</span> <span class="token string">''</span><span class="token punctuation">,</span>
  <span class="token string-property property">'X-CSRFToken'</span><span class="token operator">:</span> csrftoken<span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div>
<p>If a valid token is sent, we'll have access to the user's identity in the <code>user</code> attribute of the <code>request</code> object. We can thus define the handling of the request accordingly:</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-python"><code><span class="token keyword">def</span> <span class="token function">create</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># Handle user is not authenticated</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> request<span class="token punctuation">.</span>user<span class="token punctuation">.</span>is_authenticated<span class="token punctuation">:</span>
        <span class="token keyword">raise</span> PermissionDenied<span class="token punctuation">(</span>
            <span class="token punctuation">{</span><span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"You must be logged in to access this resource."</span><span class="token punctuation">}</span>
        <span class="token punctuation">)</span>
    <span class="token comment"># Get grid object from slug</span>
    grid <span class="token operator">=</span> get_object_or_404<span class="token punctuation">(</span>Grid<span class="token punctuation">,</span> slug<span class="token operator">=</span>request<span class="token punctuation">.</span>data<span class="token punctuation">[</span><span class="token string">"grid"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> is_deleted<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    <span class="token comment"># Handle grid does not belong to user</span>
    <span class="token keyword">if</span> grid<span class="token punctuation">.</span>user <span class="token operator">!=</span> request<span class="token punctuation">.</span>user<span class="token punctuation">:</span>
        <span class="token keyword">raise</span> PermissionDenied<span class="token punctuation">(</span>
            <span class="token punctuation">{</span><span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"You don't have permission to add links to this grid."</span><span class="token punctuation">}</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre></div>
<h2 id="optimisation"><a href="#optimisation" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Optimisation</h2>
<p>Django's ORM is incredibly useful, but is has one rule for oerformance and optimisation: <strong>work at the appropriate level</strong>. This means performing operations at the database level, instead of through multiple levels of abstraction and layers of machinery.</p>
<p>This is because SQL is purpose-built for querying and manipulating structured data. Additionally, SQL has built-in aggregation functions that can optimise and even reduce the complexity of operations.</p>
<p>For example, how can we efficiently check the total number of links created?</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-python"><code>links <span class="token operator">=</span> Link<span class="token punctuation">.</span>objects<span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

n <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>links<span class="token punctuation">)</span>  <span class="token comment"># O(n) Python operations</span>
n <span class="token operator">=</span> links<span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># SQL COUNT() -> O(n) SQL operations, O(1) if row count cached</span>
</code></pre></div>
<h3 id="indexing"><a href="#indexing" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Indexing</h3>
<p>A database index is used to find out where a data row is located in a table. The benefit is that we don't have to scan the entire table when querying on an index.</p>
<p>By default, an auto-incrementing primary key serves as the sole index of a table. An easy way to improve query performance is to index additional columns. For example, in the user table, we can index by username in order to retrieve a user's details by username in O(1) time instead of O(n). Similarly, we can perform a uniqueness check on any indexed field in O(1) time.</p>
<p>A link's slug field is explicitly indexed within its database model:</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-python"><code><span class="token keyword">class</span> <span class="token class-name">Link</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Model<span class="token punctuation">)</span><span class="token punctuation">:</span>
    grid <span class="token operator">=</span> models<span class="token punctuation">.</span>ForeignKey<span class="token punctuation">(</span>Grid<span class="token punctuation">,</span> on_delete<span class="token operator">=</span>models<span class="token punctuation">.</span>CASCADE<span class="token punctuation">,</span> related_name<span class="token operator">=</span><span class="token string">"links"</span><span class="token punctuation">)</span>
    slug <span class="token operator">=</span> models<span class="token punctuation">.</span>SlugField<span class="token punctuation">(</span>
        unique<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> db_index<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> default<span class="token operator">=</span>generate_slug<span class="token punctuation">,</span> editable<span class="token operator">=</span><span class="token boolean">False</span>
    <span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre></div>
<h3 id="select-related"><a href="#select-related" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Select related</h3>
<p>A <code>JOIN</code> clause is used to efficiently query data from multiple tables based on a shared column.</p>
<p>When fetching a link, the slug of its grid is returned in the response. However, within the database, the grid's primary key is stored in order to represent that relationship natively. Therefore, we need to query the slug from the grid object.</p>
<p>In order to serialise a list of 27 links <strong>without using an inner join</strong>, we'd need 28 queries. This is why it's often referred to as the N+1 Queries problem.</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-sql"><code><span class="token number">1.</span> <span class="token keyword">SELECT</span> <span class="token string">"links_link"</span><span class="token punctuation">.</span><span class="token string">"id"</span><span class="token punctuation">,</span> <span class="token string">"links_link"</span><span class="token punctuation">.</span><span class="token string">"grid_id"</span><span class="token punctuation">,</span> <span class="token string">"links_link"</span><span class="token punctuation">.</span><span class="token string">"slug"</span> <span class="token keyword">FROM</span> <span class="token string">"links_link"</span>

<span class="token number">2.</span> <span class="token keyword">SELECT</span> <span class="token string">"grids_grid"</span><span class="token punctuation">.</span><span class="token string">"id"</span><span class="token punctuation">,</span> <span class="token string">"grids_grid"</span><span class="token punctuation">.</span><span class="token string">"user_id"</span><span class="token punctuation">,</span> <span class="token string">"grids_grid"</span><span class="token punctuation">.</span><span class="token string">"slug"</span><span class="token punctuation">,</span>  <span class="token keyword">FROM</span> <span class="token string">"grids_grid"</span> <span class="token keyword">WHERE</span> <span class="token string">"grids_grid"</span><span class="token punctuation">.</span><span class="token string">"id"</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">LIMIT</span> <span class="token number">21</span>

<span class="token number">3.</span> <span class="token keyword">SELECT</span> <span class="token string">"grids_grid"</span><span class="token punctuation">.</span><span class="token string">"id"</span><span class="token punctuation">,</span> <span class="token string">"grids_grid"</span><span class="token punctuation">.</span><span class="token string">"user_id"</span><span class="token punctuation">,</span> <span class="token string">"grids_grid"</span><span class="token punctuation">.</span><span class="token string">"slug"</span><span class="token punctuation">,</span>  <span class="token keyword">FROM</span> <span class="token string">"grids_grid"</span> <span class="token keyword">WHERE</span> <span class="token string">"grids_grid"</span><span class="token punctuation">.</span><span class="token string">"id"</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">LIMIT</span> <span class="token number">21</span>

<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>

<span class="token number">27.</span> <span class="token keyword">SELECT</span> <span class="token string">"grids_grid"</span><span class="token punctuation">.</span><span class="token string">"id"</span><span class="token punctuation">,</span> <span class="token string">"grids_grid"</span><span class="token punctuation">.</span><span class="token string">"user_id"</span><span class="token punctuation">,</span> <span class="token string">"grids_grid"</span><span class="token punctuation">.</span><span class="token string">"slug"</span><span class="token punctuation">,</span>  <span class="token keyword">FROM</span> <span class="token string">"grids_grid"</span> <span class="token keyword">WHERE</span> <span class="token string">"grids_grid"</span><span class="token punctuation">.</span><span class="token string">"id"</span> <span class="token operator">=</span> <span class="token number">9</span> <span class="token keyword">LIMIT</span> <span class="token number">21</span>

<span class="token number">28.</span> <span class="token keyword">SELECT</span> <span class="token string">"grids_grid"</span><span class="token punctuation">.</span><span class="token string">"id"</span><span class="token punctuation">,</span> <span class="token string">"grids_grid"</span><span class="token punctuation">.</span><span class="token string">"user_id"</span><span class="token punctuation">,</span> <span class="token string">"grids_grid"</span><span class="token punctuation">.</span><span class="token string">"slug"</span><span class="token punctuation">,</span>  <span class="token keyword">FROM</span> <span class="token string">"grids_grid"</span> <span class="token keyword">WHERE</span> <span class="token string">"grids_grid"</span><span class="token punctuation">.</span><span class="token string">"id"</span> <span class="token operator">=</span> <span class="token number">9</span> <span class="token keyword">LIMIT</span> <span class="token number">21</span>
</code></pre></div>
<p>Django's ORM provides <code>select_related()</code>, which will follow foreign-key relationships and fetch any additional related-object data by creating an SQL join.</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-python"><code><span class="token keyword">def</span> <span class="token function">retrieve</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> pk<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    qs <span class="token operator">=</span> Link<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>select_related<span class="token punctuation">(</span><span class="token string">"grid"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    link <span class="token operator">=</span> get_object_or_404<span class="token punctuation">(</span>qs<span class="token punctuation">,</span> slug<span class="token operator">=</span>pk<span class="token punctuation">,</span> is_deleted<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre></div>
<p>This turns the 28 queries above into a single, efficient query:</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-sql"><code><span class="token number">1.</span> <span class="token keyword">SELECT</span> <span class="token string">"links_link"</span><span class="token punctuation">.</span><span class="token string">"id"</span><span class="token punctuation">,</span> <span class="token string">"links_link"</span><span class="token punctuation">.</span><span class="token string">"grid_id"</span><span class="token punctuation">,</span> <span class="token string">"links_link"</span><span class="token punctuation">.</span><span class="token string">"slug"</span><span class="token punctuation">,</span> <span class="token string">"grids_grid"</span><span class="token punctuation">.</span><span class="token string">"id"</span><span class="token punctuation">,</span> <span class="token string">"grids_grid"</span><span class="token punctuation">.</span><span class="token string">"slug"</span><span class="token punctuation">,</span> <span class="token keyword">FROM</span> <span class="token string">"links_link"</span> <span class="token keyword">INNER</span> <span class="token keyword">JOIN</span> <span class="token string">"grids_grid"</span> <span class="token keyword">ON</span> <span class="token punctuation">(</span><span class="token string">"links_link"</span><span class="token punctuation">.</span><span class="token string">"grid_id"</span> <span class="token operator">=</span> <span class="token string">"grids_grid"</span><span class="token punctuation">.</span><span class="token string">"id"</span><span class="token punctuation">)</span>
</code></pre></div>
<h3 id="prefetch-related"><a href="#prefetch-related" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Prefetch related</h3>
<p>The ORM also provides <code>prefetch_related()</code> in order to avoid iterating over a one-to-many relationship.</p>
<p>For example, when fetching a user's profile, Gridlink will serialise all of their grids, and for each grid links, each of its links. For 1 user with 3 grids, where each grid has and 3 links, we'd have a total of 13 queries.</p>
<p>We can reduce the total number of queries by prefetching the respective grids and links:</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-python"><code><span class="token keyword">def</span> <span class="token function">retrieve</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> request<span class="token punctuation">,</span> pk<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    qs <span class="token operator">=</span> User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>prefetch_related<span class="token punctuation">(</span><span class="token string">"grids__links"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">all</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    user <span class="token operator">=</span> get_object_or_404<span class="token punctuation">(</span>qs<span class="token punctuation">,</span> username<span class="token operator">=</span>pk<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
</code></pre></div>
<p>This results in a single query per model:</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-sql"><code><span class="token number">1.</span> <span class="token keyword">SELECT</span> <span class="token string">"accounts_user"</span><span class="token punctuation">.</span><span class="token string">"id"</span><span class="token punctuation">,</span> <span class="token string">"accounts_user"</span><span class="token punctuation">.</span><span class="token string">"username"</span> <span class="token keyword">FROM</span> <span class="token string">"accounts_user"</span> <span class="token keyword">WHERE</span> <span class="token string">"accounts_user"</span><span class="token punctuation">.</span><span class="token string">"username"</span> <span class="token operator">=</span> <span class="token string">'test_user_0'</span> <span class="token keyword">LIMIT</span> <span class="token number">21</span>

<span class="token number">2.</span> <span class="token keyword">SELECT</span> <span class="token string">"grids_grid"</span><span class="token punctuation">.</span><span class="token string">"id"</span><span class="token punctuation">,</span> <span class="token string">"grids_grid"</span><span class="token punctuation">.</span><span class="token string">"user_id"</span><span class="token punctuation">,</span> <span class="token string">"grids_grid"</span><span class="token punctuation">.</span><span class="token string">"slug"</span> <span class="token keyword">FROM</span> <span class="token string">"grids_grid"</span> <span class="token keyword">WHERE</span> <span class="token string">"grids_grid"</span><span class="token punctuation">.</span><span class="token string">"user_id"</span> <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

<span class="token number">3.</span> <span class="token keyword">SELECT</span> <span class="token string">"links_link"</span><span class="token punctuation">.</span><span class="token string">"id"</span><span class="token punctuation">,</span> <span class="token string">"links_link"</span><span class="token punctuation">.</span><span class="token string">"grid_id"</span><span class="token punctuation">,</span> <span class="token string">"links_link"</span><span class="token punctuation">.</span><span class="token string">"slug"</span> <span class="token keyword">FROM</span> <span class="token string">"links_link"</span> <span class="token keyword">WHERE</span> <span class="token string">"links_link"</span><span class="token punctuation">.</span><span class="token string">"grid_id"</span> <span class="token operator">IN</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
</code></pre></div>
<h2 id="tests"><a href="#tests" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Tests</h2>
<h3 id="unit-tests"><a href="#unit-tests" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Unit tests</h3>
<h3 id="load-testing"><a href="#load-testing" aria-hidden="true" tabindex="-1"><span class="icon icon-link"></span></a>Load testing</h3>
<p>Load testing is typically performed on end-to-end infrastructure in order to test the effects of high demand. Gridlink performs load and query testing at the API level. The aim is to make sure that response times aren't creeping up as hundreds of thousands of objects are created.</p>
<p>In general, the cause of bad performance will be inefficient querying (a misused or forgetten <code>select_related()</code> or <code>prefetch_related()</code>), and its effect will be slower response times as the number of objects grow.</p>
<p>Therefore, we can check these two core characteristics:</p>
<div class="nuxt-content-highlight"><pre class="line-numbers language-python"><code><span class="token keyword">def</span> <span class="token function">setUpTestData</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># Populate test database with 1,000,000 links</span>
    n_users <span class="token operator">=</span> <span class="token number">10_000</span>
    n_grids <span class="token operator">=</span> <span class="token number">10</span>
    n_links <span class="token operator">=</span> <span class="token number">10</span>
    <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    self<span class="token punctuation">.</span>test_user <span class="token operator">=</span> User<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token builtin">id</span><span class="token operator">=</span><span class="token number">495</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">test_user_detail_time</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># Start timer</span>
    tic <span class="token operator">=</span> time<span class="token punctuation">.</span>perf_counter<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment"># Serialise a user's profile using exactly 3 queries</span>
    <span class="token keyword">with</span> self<span class="token punctuation">.</span>assertNumQueries<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        response <span class="token operator">=</span> self<span class="token punctuation">.</span>client<span class="token punctuation">.</span>get<span class="token punctuation">(</span>
            reverse<span class="token punctuation">(</span><span class="token string">"users-detail"</span><span class="token punctuation">,</span> kwargs<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">"pk"</span><span class="token punctuation">:</span> self<span class="token punctuation">.</span>test_user<span class="token punctuation">.</span>username<span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
    <span class="token comment"># Assert response is &lt; 30ms</span>
    toc <span class="token operator">=</span> time<span class="token punctuation">.</span>perf_counter<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">assert</span> toc <span class="token operator">-</span> tic <span class="token operator">&lt;</span> <span class="token number">0.03</span>
</code></pre></div></div></div></div> <div id="section" class="py-2"><div id="container" class="container mx-auto p-5"><div class="flex flex-col items-center space-y-5 sm:flex-row sm:items-start sm:space-y-0"><div class="text-sm font-semibold text-gray-50 flex-1 justify-start">
  Lewis Lloyd © 2022
</div> <div class="flex space-x-12 flex-1 justify-end"><ul class="flex flex-col"><li><p class="text-sm font-semibold text-gray-100">Pages</p></li> <li><a href="/blog/" class="text-sm text-gray-300 duration-100 hover:text-gray-400">
        Blog
      </a></li> <li><a href="/projects/" class="text-sm text-gray-300 duration-100 hover:text-gray-400 nuxt-link-active">
        Projects
      </a></li> <li><a href="/contact/" class="text-sm text-gray-300 duration-100 hover:text-gray-400">
        Contact
      </a></li></ul> <ul class="flex flex-col"><li><p class="text-sm font-semibold text-gray-100">Resources</p></li> <li><a href="https://github.com/lloydtao/portfolio" class="text-sm text-gray-300 duration-100 hover:text-gray-400">Source code</a></li> <li><a href="/storybook/" class="text-sm text-gray-300 duration-100 hover:text-gray-400">
        Storybook
      </a></li></ul> <ul class="flex flex-col"><li><p class="text-sm font-semibold text-gray-100">Other</p></li> <li><a href="/leetcode/" class="text-sm text-gray-300 duration-100 hover:text-gray-400">
        Leetcode
      </a></li> <li><a href="/graphics/" class="text-sm text-gray-300 duration-100 hover:text-gray-400">
        Graphics
      </a></li></ul></div></div></div></div></div></div></div></div></div><script defer src="/_nuxt/static/1672247031/projects/gridlink-building-a-scalable-backend/state.js"></script><script src="/_nuxt/4bb0e76.js" defer></script><script src="/_nuxt/7405a57.js" defer></script><script src="/_nuxt/6d3c2ac.js" defer></script><script src="/_nuxt/3d589a9.js" defer></script><script src="/_nuxt/0c8a44b.js" defer></script>
  </body>
</html>
